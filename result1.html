<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Result</title>
</head>
<body>

    <h2>Search Student Result</h2>
    <form id="searchForm">
        <label for="class">Class:</label>
        <input type="text" id="class" name="class"><br><br>

        <label for="roll">Roll Number:</label>
        <input type="text" id="roll" name="roll"><br><br>

        <input type="submit" value="Search">
    </form>

    <h3>Result:</h3>
    <table id="resultTable">
        <!-- Results will be displayed here -->
    </table>

    <script>
        // Fetch data from Google Sheets CSV URL
        function fetchData() {
            var className = document.getElementById('class').value;
            var rollNumber = document.getElementById('roll').value;

            var spreadsheetId = 'your-sheet-id';  // Replace with your Google Sheets ID
            var sheetUrl = `https://docs.google.com/spreadsheets/d/${1vllKIHCAQn5cWdbOmQK3__v9oPfYcV-pgW9RYETuvxo
}/export?format=csv`;

            fetch(sheetUrl)
                .then(response => response.text())
                .then(csvData => {
                    var data = CSVToArray(csvData);
                    var resultTable = document.getElementById('resultTable');
                    resultTable.innerHTML = "";  // Clear any previous results

                    // Loop through the data and display results based on class and roll number
                    for (var i = 1; i < data.length; i++) {
                        var row = data[i];
                        if (row[1] == className && row[2] == rollNumber) {
                            var newRow = resultTable.insertRow();
                            newRow.insertCell(0).innerText = "Student Name: " + row[0];
                            newRow.insertCell(1).innerText = "Class: " + row[1];
                            newRow.insertCell(2).innerText = "Roll Number: " + row[2];
                            newRow.insertCell(3).innerText = "Math: " + row[3];
                            newRow.insertCell(4).innerText = "Science: " + row[4];
                            newRow.insertCell(5).innerText = "English: " + row[5];
                            newRow.insertCell(6).innerText = "History: " + row[6];
                            newRow.insertCell(7).innerText = "Geography: " + row[7];
                        }
                    }
                })
                .catch(error => {
                    console.error("Error fetching data", error);
                });
        }

        // Convert CSV data to array
        function CSVToArray(csv) {
            var rows = csv.split("\n");
            var result = [];
            for (var i = 0; i < rows.length; i++) {
                result.push(rows[i].split(","));
            }
            return result;
        }

        // Event listener for form submission
        document.getElementById('searchForm').addEventListener('submit', function(event) {
            event.preventDefault();
            fetchData();
        });
    </script>

</body>
</html>
